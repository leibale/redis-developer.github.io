"use strict";(self.webpackChunkredis_developer_hub=self.webpackChunkredis_developer_hub||[]).push([[9461],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>m});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=a.createContext({}),d=function(e){var t=a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=d(r),m=n,h=c["".concat(s,".").concat(m)]||c[m]||u[m]||o;return r?a.createElement(h,i(i({ref:t},p),{},{components:r})):a.createElement(h,i({ref:t},p))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var d=2;d<o;d++)i[d]=r[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}c.displayName="MDXCreateElement"},85162:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(67294),n=r(86010);const o="tabItem_Ymn6";function i(e){let{children:t,hidden:r,className:i}=e;return a.createElement("div",{role:"tabpanel",className:(0,n.Z)(o,i),hidden:r},t)}},65488:(e,t,r)=>{r.d(t,{Z:()=>m});var a=r(87462),n=r(67294),o=r(86010),i=r(72389),l=r(67392),s=r(7094),d=r(12466);const p="tabList__CuJ",u="tabItem_LNqP";function c(e){var t;const{lazy:r,block:i,defaultValue:c,values:m,groupId:h,className:k}=e,v=n.Children.map(e.children,(e=>{if((0,n.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),b=m??v.map((e=>{let{props:{value:t,label:r,attributes:a}}=e;return{value:t,label:r,attributes:a}})),f=(0,l.l)(b,((e,t)=>e.value===t.value));if(f.length>0)throw new Error(`Docusaurus error: Duplicate values "${f.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const g=null===c?c:c??(null==(t=v.find((e=>e.props.default)))?void 0:t.props.value)??v[0].props.value;if(null!==g&&!b.some((e=>e.value===g)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${g}" but none of its children has the corresponding value. Available values are: ${b.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:y,setTabGroupChoices:T}=(0,s.U)(),[N,O]=(0,n.useState)(g),S=[],{blockElementScrollPositionUntilNextRender:R}=(0,d.o5)();if(null!=h){const e=y[h];null!=e&&e!==N&&b.some((t=>t.value===e))&&O(e)}const w=e=>{const t=e.currentTarget,r=S.indexOf(t),a=b[r].value;a!==N&&(R(t),O(a),null!=h&&T(h,String(a)))},I=e=>{var t;let r=null;switch(e.key){case"Enter":w(e);break;case"ArrowRight":{const t=S.indexOf(e.currentTarget)+1;r=S[t]??S[0];break}case"ArrowLeft":{const t=S.indexOf(e.currentTarget)-1;r=S[t]??S[S.length-1];break}}null==(t=r)||t.focus()};return n.createElement("div",{className:(0,o.Z)("tabs-container",p)},n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":i},k)},b.map((e=>{let{value:t,label:r,attributes:i}=e;return n.createElement("li",(0,a.Z)({role:"tab",tabIndex:N===t?0:-1,"aria-selected":N===t,key:t,ref:e=>S.push(e),onKeyDown:I,onClick:w},i,{className:(0,o.Z)("tabs__item",u,null==i?void 0:i.className,{"tabs__item--active":N===t})}),r??t)}))),r?(0,n.cloneElement)(v.filter((e=>e.props.value===N))[0],{className:"margin-top--md"}):n.createElement("div",{className:"margin-top--md"},v.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==N})))))}function m(e){const t=(0,i.Z)();return n.createElement(c,(0,a.Z)({key:String(t)},e))}},62179:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>m,frontMatter:()=>l,metadata:()=>d,toc:()=>u});var a=r(87462),n=(r(67294),r(3905)),o=r(65488),i=r(85162);const l={id:"index-riot",title:"RIOT",sidebar_label:"RIOT",slug:"/tools/riot"},s=void 0,d={unversionedId:"tools/riot/index-riot",id:"tools/riot/index-riot",title:"RIOT",description:"Redis Input/Output Tools (RIOT) is a set of import/export command line utilities for Redis:",source:"@site/docs/tools/riot/index-riot.mdx",sourceDirName:"tools/riot",slug:"/tools/riot",permalink:"/tools/riot",draft:!1,editUrl:"https://github.com/redis-developer/redis-developer/edit/master/docs/tools/riot/index-riot.mdx",tags:[],version:"current",lastUpdatedAt:1700152680,formattedLastUpdatedAt:"Nov 16, 2023",frontMatter:{id:"index-riot",title:"RIOT",sidebar_label:"RIOT",slug:"/tools/riot"}},p={},u=[{value:"1. Getting Started",id:"1-getting-started",level:3},{value:"2. Build and Run",id:"2-build-and-run",level:3},{value:"3. Install via Homebrew (macOS)",id:"3-install-via-homebrew-macos",level:3},{value:"Usage",id:"usage",level:3},{value:"4. Example",id:"4-example",level:3},{value:"5. Verification",id:"5-verification",level:3},{value:"6. Architecture",id:"6-architecture",level:3},{value:"1. Getting Started",id:"1-getting-started-1",level:3},{value:"2. Build and Run",id:"2-build-and-run-1",level:3},{value:"3. Install via Homebrew (macOS)",id:"3-install-via-homebrew-macos-1",level:3},{value:"4. Usage",id:"4-usage",level:3},{value:"5. Drivers",id:"5-drivers",level:3},{value:"Oracle",id:"oracle",level:4},{value:"IBM Db2",id:"ibm-db2",level:4},{value:"MS SQL Server",id:"ms-sql-server",level:4},{value:"MySQL",id:"mysql",level:4},{value:"PostgreSQL",id:"postgresql",level:4},{value:"SQLite",id:"sqlite",level:4},{value:"6. Import",id:"6-import",level:3},{value:"Import from PostgreSQL",id:"import-from-postgresql",level:4},{value:"Import into hashes",id:"import-into-hashes",level:4},{value:"Import into hashes and set TTL on the key",id:"import-into-hashes-and-set-ttl-on-the-key",level:4},{value:"Import into hashes and set TTL and add to a set named myset",id:"import-into-hashes-and-set-ttl-and-add-to-a-set-named-myset",level:4},{value:"7. Export",id:"7-export",level:3},{value:"Export to PostgreSQL",id:"export-to-postgresql",level:4},{value:"Import from PostgreSQL to JSON strings",id:"import-from-postgresql-to-json-strings",level:4}],c={toc:u};function m(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Redis Input/Output Tools (RIOT) is a set of import/export command line utilities for Redis:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"RIOT Redis: live replication from any Redis database (including AWS Elasticache) to another Redis database."),(0,n.kt)("li",{parentName:"ul"},"RIOT DB: migrate from an RDBMS to Redis, Search, JSON, ...")),(0,n.kt)(o.Z,{defaultValue:"RIOT Redis",values:[{label:"RIOT Redis",value:"RIOT Redis"},{label:"RIOT DB",value:"RIOT DB"}],mdxType:"Tabs"},(0,n.kt)(i.Z,{value:"RIOT Redis",mdxType:"TabItem"},(0,n.kt)("p",null,"Most database migration tools available today are offline in nature. Migrating data from AWS ElastiCache to Redis Cloud for example means backing up your Elasticache data to an AWS S3 bucket and importing it into Redis Cloud using its UI.This implies some downtime and might result in data loss.\nOther available techniques include creating point-in-time snapshots of the source Redis server & applying the changes to the destination servers to keep both servers in sync.\nIt might sound like a good approach but can be challenging when you have to maintain dozens of scripts to implement the migration strategy."),(0,n.kt)("p",null,"RIOT Redis is a migration tool that allows for seamless live replication between two Redis databases."),(0,n.kt)("h3",{id:"1-getting-started"},"1. Getting Started"),(0,n.kt)("p",null,"Download the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/redis-developer/riot/releases/latest"},"latest release")," and unzip the archive."),(0,n.kt)("p",null,"Launch the ",(0,n.kt)("inlineCode",{parentName:"p"},"bin/riot-redis")," script and follow the usage information provided."),(0,n.kt)("h3",{id:"2-build-and-run"},"2. Build and Run"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"git clone https://github.com/redis-developer/riot.git\ncd riot/riot-redis\n./riot-redis\n")),(0,n.kt)("h3",{id:"3-install-via-homebrew-macos"},"3. Install via Homebrew (macOS)"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"brew install jruaux/tap/riot-redis`\n")),(0,n.kt)("h3",{id:"usage"},"Usage"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"\u276f riot-redis\nUsage: {app} [OPTIONS] [COMMAND]\n      --help                Show this help message and exit.\n  -V, --version             Print version information and exit.\n  -q, --quiet               Log errors only\n  -d, --debug               Log in debug mode (includes normal stacktrace)\n  -i, --info                Set log level to info\n")),(0,n.kt)("p",null,"You can use --help on any subcommand:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"\u276f riot-redis --help\n\n\u276f riot-redis import --help\n\n\u276f riot-redis import ..  hset --help\n")),(0,n.kt)("p",null,"Redis connection options are the same as redis-cli:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"  -h, --hostname=<host>     Server hostname (default: 127.0.0.1)\n  -p, --port=<port>         Server port (default: 6379)\n  -s, --socket=<socket>     Server socket (overrides hostname and port)\n      --user=<username>     Used to send ACL style 'AUTH username pass'. Needs password.\n  -a, --pass[=<password>]   Password to use when connecting to the server\n  -u, --uri=<uri>           Server URI\n  -o, --timeout=<sec>       Redis command timeout (default: 60)\n  -n, --db=<int>            Database number (default: 0)\n  -c, --cluster             Enable cluster mode\n  -t, --tls                 Establish a secure TLS connection\n  -l, --latency             Show latency metrics\n  -m, --pool=<int>          Max pool connections (default: 8)\n")),(0,n.kt)("p",null,"Redis URI syntax is described here."),(0,n.kt)("h3",{id:"4-example"},"4. Example"),(0,n.kt)("p",null,"Here is an example of a live replication from a source Redis running on localhost and port 6379, to a target Redis running on localhost and port 6380:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"\u276f riot-redis -h source -p 6379 replicate --idle-timeout 500 -h target -p 6380 --live\n")),(0,n.kt)("h3",{id:"5-verification"},"5. Verification"),(0,n.kt)("p",null,"Once replication is complete RIOT Redis will perform a verification step to compare values and TTLs between source and target databases. The output looks like this:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"OK:1000 V:0 >:0 <:0 T:0\n")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"OK: # identical values")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"V: # mismatched values")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("blockquote",{parentName:"li"},(0,n.kt)("p",{parentName:"blockquote"},": # keys only present in source database"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"<: # keys only present in target database")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"T: # keys with TTL difference greater than tolerance"))),(0,n.kt)("h3",{id:"6-architecture"},"6. Architecture"),(0,n.kt)("p",null,"RIOT Redis implements client-side replication using a producer/consumer approach:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"the producer is connected to the source Redis (e.g. ElastiCache) and iterates over keys to read their corresponding values")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"the consumer is connected to the target Redis (e.g. Redis Cloud) and writes the key/value tuples previously created"))),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Key reader: initiates a SCAN and optionally calls SUBSCRIBE to listen for keyspace notifications (live replication)."),(0,n.kt)("li",{parentName:"ol"},"Value reader: takes the keys and calls DUMP and TTL."),(0,n.kt)("li",{parentName:"ol"},"Key/Value writer: takes key/value/ttl tuples and calls RESTORE and EXPIRE.")),(0,n.kt)("admonition",{type:"note"},(0,n.kt)("p",{parentName:"admonition"},"Live replication makes use of keyspace notifications. Make sure the source Redis database has keyspace notifications enabled using notify-keyspace-events = KA in redis.conf or via CONFIG SET.")),(0,n.kt)("admonition",{type:"note"},(0,n.kt)("p",{parentName:"admonition"},"The live replication mechanism does not guarantee data consistency. Redis sends keyspace notifications over pub/sub which does not provide guaranteed delivery. It is possible that RIOT Redis can miss some notifications in case of network failures for example."))),(0,n.kt)(i.Z,{value:"RIOT DB",mdxType:"TabItem"},(0,n.kt)("p",null,"RIOT DB lets you import/export data from relational databases."),(0,n.kt)("h3",{id:"1-getting-started-1"},"1. Getting Started"),(0,n.kt)("p",null,"Download the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/redis-developer/riot/releases/latest"},"latest release")," and unzip the archive."),(0,n.kt)("p",null,"Launch the bin/riot-db script and follow the usage information provided."),(0,n.kt)("h3",{id:"2-build-and-run-1"},"2. Build and Run"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"\u276f git clone https://github.com/redis-developer/riot.git\n\u276f cd riot/riot-db\n\u276f ./riot-db\n")),(0,n.kt)("h3",{id:"3-install-via-homebrew-macos-1"},"3. Install via Homebrew (macOS)"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"brew install jruaux/tap/riot-db\n")),(0,n.kt)("h3",{id:"4-usage"},"4. Usage"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"\u276f riot-db\nUsage: riot-db [OPTIONS] [COMMAND]\n      --help                Show this help message and exit.\n  -V, --version             Print version information and exit.\n  -q, --quiet               Log errors only\n  -d, --debug               Log in debug mode (includes normal stacktrace)\n  -i, --info                Set log level to info\n")),(0,n.kt)("p",null,"You can use --help on any subcommand:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"\u276f riot-db --help\n\u276f riot-db import --help\n\u276f riot-db import \u2026 hset --help\n")),(0,n.kt)("p",null,"Redis connection options are the same as redis-cli:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"  -h, --hostname=<host>     Server hostname (default: 127.0.0.1)\n  -p, --port=<port>         Server port (default: 6379)\n  -s, --socket=<socket>     Server socket (overrides hostname and port)\n      --user=<username>     Used to send ACL style 'AUTH username pass'. Needs password.\n  -a, --pass[=<password>]   Password to use when connecting to the server\n  -u, --uri=<uri>           Server URI\n  -o, --timeout=<sec>       Redis command timeout (default: 60)\n  -n, --db=<int>            Database number (default: 0)\n  -c, --cluster             Enable cluster mode\n  -t, --tls                 Establish a secure TLS connection\n  -l, --latency             Show latency metrics\n  -m, --pool=<int>          Max pool connections (default: 8)\n\n")),(0,n.kt)("h3",{id:"5-drivers"},"5. Drivers"),(0,n.kt)("p",null,"RIOT DB includes drivers for the most common RDBMSs:"),(0,n.kt)("h4",{id:"oracle"},"Oracle"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"jdbc:oracle:thin:@myhost:1521:orcl\n")),(0,n.kt)("h4",{id:"ibm-db2"},"IBM Db2"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"jdbc:db2://host:port/database\n")),(0,n.kt)("h4",{id:"ms-sql-server"},"MS SQL Server"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"jdbc:sqlserver://[serverName[\\instanceName][:portNumber]][;property=value[;property=value]]\n")),(0,n.kt)("h4",{id:"mysql"},"MySQL"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"jdbc:mysql://[host]:[port][/database][?properties]\n")),(0,n.kt)("h4",{id:"postgresql"},"PostgreSQL"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"jdbc:postgresql://host:port/database\n")),(0,n.kt)("h4",{id:"sqlite"},"SQLite"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"jdbc:sqlite:sqlite_database_file_path\n")),(0,n.kt)("p",null,"For non-included databases you must install the corresponding JDBC driver under the lib directory and modify the RIOT DB CLASSPATH:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"*nix: bin/riot-db \u2192 CLASSPATH=$APP_HOME/lib/myjdbc.jar:$APP_HOME/lib/\u2026\nWindows: bin{app}.bat \u2192 set CLASSPATH=%APP_HOME%\\lib\\myjdbc.jar;%APP_HOME%\\lib\\\u2026\n")),(0,n.kt)("h3",{id:"6-import"},"6. Import"),(0,n.kt)("p",null,"Use the import command to import the result set of a SQL statement."),(0,n.kt)("h4",{id:"import-from-postgresql"},"Import from PostgreSQL"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'\u276f riot-db -h localhost -p 6379 import "SELECT * FROM orders" --url jdbc:postgresql://host:port/database --username appuser --password passwd hset --keyspace order --keys order_id\n')),(0,n.kt)("p",null,"You can specify one or many Redis commands as targets of the import:"),(0,n.kt)("h4",{id:"import-into-hashes"},"Import into hashes"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"\u276f riot-db import .. set --keyspace blah --keys id\n")),(0,n.kt)("h4",{id:"import-into-hashes-and-set-ttl-on-the-key"},"Import into hashes and set TTL on the key"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"\u276f riot-db import .. hset --keyspace blah --keys id expire --keyspace blah --keys id\n")),(0,n.kt)("h4",{id:"import-into-hashes-and-set-ttl-and-add-to-a-set-named-myset"},"Import into hashes and set TTL and add to a set named myset"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"\u276f riot-db import .. hset --keyspace blah --keys id expire --keyspace blah --keys id sadd --keyspace myset --members id\n")),(0,n.kt)("h3",{id:"7-export"},"7. Export"),(0,n.kt)("h4",{id:"export-to-postgresql"},"Export to PostgreSQL"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'\u276f riot-db export "INSERT INTO mytable (id, field1, field2) VALUES (CAST(:id AS SMALLINT), :field1, :field2)" --url jdbc:postgresql://host:port/database --username appuser --password passwd --scan-match "hash:*" --key-regex "hash:(?<id>.*)"\n')),(0,n.kt)("h4",{id:"import-from-postgresql-to-json-strings"},"Import from PostgreSQL to JSON strings"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'\u276f riot-db -h localhost -p 6379 import "SELECT * FROM orders" --url jdbc:postgresql://host:port/database --username appuser --password passwd set --keyspace order --keys order_id\n')),(0,n.kt)("p",null,"This will produce Redis strings that look like this:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},'{\n        "order_id": 10248,\n        "customer_id": "VINET",\n        "employee_id": 5,\n        "order_date": "1996-07-04",\n        "required_date": "1996-08-01",\n        "shipped_date": "1996-07-16",\n        "ship_via": 3,\n        "freight": 32.38,\n        "ship_name": "Vins et alcools Chevalier",\n        "ship_address": "59 rue de l\'Abbaye",\n        "ship_city": "Reims",\n        "ship_postal_code": "51100",\n        "ship_country": "France"\n}\n')))))}m.isMDXComponent=!0}}]);