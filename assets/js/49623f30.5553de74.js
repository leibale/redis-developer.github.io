"use strict";(self.webpackChunkredis_developer_hub=self.webpackChunkredis_developer_hub||[]).push([[1358,1638,3007,8962,1849],{3905:(e,t,i)=>{i.d(t,{Zo:()=>l,kt:()=>m});var a=i(67294);function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function r(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function s(e,t){if(null==e)return{};var i,a,n=function(e,t){if(null==e)return{};var i,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)i=o[a],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)i=o[a],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}var c=a.createContext({}),d=function(e){var t=a.useContext(c),i=t;return e&&(i="function"==typeof e?e(t):r(r({},t),e)),i},l=function(e){var t=d(e.components);return a.createElement(c.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var i=e.components,n=e.mdxType,o=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),p=d(i),m=n,u=p["".concat(c,".").concat(m)]||p[m]||h[m]||o;return i?a.createElement(u,r(r({ref:t},l),{},{components:i})):a.createElement(u,r({ref:t},l))}));function m(e,t){var i=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=i.length,r=new Array(o);r[0]=p;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:n,r[1]=s;for(var d=2;d<o;d++)r[d]=i[d];return a.createElement.apply(null,r)}return a.createElement.apply(null,i)}p.displayName="MDXCreateElement"},50358:(e,t,i)=>{i.d(t,{Z:()=>c});var a=i(67294),n=i(52263);const o="authorByline_VoxI",r="authorLabel_a70t",s="authorProfileImage_URwT";const c=function(e){let{frontMatter:t}=e;const{siteConfig:i}=(0,n.Z)(),c=i.customFields.authors;return a.createElement(a.Fragment,null,t.authors&&a.createElement("div",{className:"docAuthors"},a.createElement("hr",null),t.authors.map((e=>a.createElement("div",{key:e,className:o},a.createElement("img",{className:s,src:`/img/${c[e].image?c[e].image:"default_author_profile_pic.png"}`,alt:`Profile picture for ${c[e].name}`}),a.createElement("div",null,a.createElement("div",{className:r},"Author:"),a.createElement("div",null,a.createElement("a",{href:c[e].link,target:"_blank"},c[e].name),", ",c[e].title))))),a.createElement("hr",null)))}},94047:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var a=i(87462),n=(i(67294),i(3905));const o={},r=void 0,s={unversionedId:"howtos/solutions/caching-architecture/common-caching/caching-movie-app",id:"howtos/solutions/caching-architecture/common-caching/caching-movie-app",title:"caching-movie-app",description:"The demo application used in the rest of this tutorial showcases a movie application with basic create, read, update, and delete (CRUD) operations.",source:"@site/docs/howtos/solutions/caching-architecture/common-caching/caching-movie-app.mdx",sourceDirName:"howtos/solutions/caching-architecture/common-caching",slug:"/howtos/solutions/caching-architecture/common-caching/caching-movie-app",permalink:"/howtos/solutions/caching-architecture/common-caching/caching-movie-app",draft:!1,editUrl:"https://github.com/redis-developer/redis-developer/edit/master/docs/howtos/solutions/caching-architecture/common-caching/caching-movie-app.mdx",tags:[],version:"current",lastUpdatedAt:1681340538,formattedLastUpdatedAt:"Apr 12, 2023",frontMatter:{}},c={},d=[],l={toc:d};function h(e){let{components:t,...o}=e;return(0,n.kt)("wrapper",(0,a.Z)({},l,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"The demo application used in the rest of this tutorial showcases a movie application with basic create, read, update, and delete (CRUD) operations.\n",(0,n.kt)("img",{alt:"demo-01",src:i(82989).Z,width:"2616",height:"1348"})),(0,n.kt)("p",null,"The movie application dashboard contains a search section at the top and a list of movie cards in the middle. The floating plus icon displays a pop-up when the user selects it, permitting the user to enter new movie details. The search section has a text search bar and a toggle link between text search and basic (that is, form-based) search. Each movie card has edit and delete icons, which are displayed when a mouse hovers over the card."))}h.isMDXComponent=!0},2327:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var a=i(87462),n=(i(67294),i(3905));const o={},r=void 0,s={unversionedId:"howtos/solutions/caching-architecture/common-caching/redis-gears",id:"howtos/solutions/caching-architecture/common-caching/redis-gears",title:"redis-gears",description:"What is RedisGears?",source:"@site/docs/howtos/solutions/caching-architecture/common-caching/redis-gears.mdx",sourceDirName:"howtos/solutions/caching-architecture/common-caching",slug:"/howtos/solutions/caching-architecture/common-caching/redis-gears",permalink:"/howtos/solutions/caching-architecture/common-caching/redis-gears",draft:!1,editUrl:"https://github.com/redis-developer/redis-developer/edit/master/docs/howtos/solutions/caching-architecture/common-caching/redis-gears.mdx",tags:[],version:"current",lastUpdatedAt:1681340538,formattedLastUpdatedAt:"Apr 12, 2023",frontMatter:{}},c={},d=[{value:"What is RedisGears?",id:"what-is-redisgears",level:3},{value:"How do I use RedisGears?",id:"how-do-i-use-redisgears",level:3},{value:"Using gears-cli",id:"using-gears-cli",level:3},{value:"RedisGears references",id:"redisgears-references",level:3}],l={toc:d};function h(e){let{components:t,...i}=e;return(0,n.kt)("wrapper",(0,a.Z)({},l,i,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h3",{id:"what-is-redisgears"},"What is RedisGears?"),(0,n.kt)("p",null,"RedisGears is a programmable serverless engine for transaction, batch, and event-driven data processing allowing users to write and run their own functions on data stored in Redis."),(0,n.kt)("p",null,"Functions can be implemented in different languages, including Python and C, and can be executed by the RedisGears engine in one of two ways:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Batch"),": triggered by the ",(0,n.kt)("a",{parentName:"li",href:"https://oss.redislabs.com/redisgears/functions.html#run"},"Run")," action, execution is immediate and on existing data"),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Event"),": triggered by the ",(0,n.kt)("a",{parentName:"li",href:"https://oss.redislabs.com/redisgears/functions.html#register"},"Register")," action, execution is triggered by new events and on their data")),(0,n.kt)("p",null,"Some ",(0,n.kt)("strong",{parentName:"p"},"batch")," type operations RedisGears can do:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Run an operation on all keys in the KeySpace or keys matching a certain pattern like :",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Prefix all KeyNames with ",(0,n.kt)("inlineCode",{parentName:"li"},"person:")),(0,n.kt)("li",{parentName:"ul"},"Delete all keys whose value is smaller than zero"),(0,n.kt)("li",{parentName:"ul"},"Write all the KeyNames starting with ",(0,n.kt)("inlineCode",{parentName:"li"},"person:")," to a set"))),(0,n.kt)("li",{parentName:"ul"},"Run a set of operations on all(or matched) keys where the output of one operation is the input of another like",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Find all keys with a prefix ",(0,n.kt)("inlineCode",{parentName:"li"},"person:")," (assume all of them are of type hash)"),(0,n.kt)("li",{parentName:"ul"},"Increase user's days_old by 1, then sum them by age group (10-20, 20-30 etc.)"),(0,n.kt)("li",{parentName:"ul"},"Add today's stats to the sorted set of every client, calculate last 7 days average and save the computed result in a string")))),(0,n.kt)("p",null,"Some ",(0,n.kt)("strong",{parentName:"p"},"event")," type operations RedisGears can do:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"RedisGears can also register event listeners that will trigger a function execution every time a watched key is changed like",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Listen for all operations on all keys and keep a list of all KeyNames in the KeySpace"),(0,n.kt)("li",{parentName:"ul"},"Listen for DEL operations on keys with a prefix ",(0,n.kt)("inlineCode",{parentName:"li"},"I-AM-IMPORTANT:"),' and asynchronously dump them in a "deleted keys" log file'),(0,n.kt)("li",{parentName:"ul"},"Listen for all HINCRBY operations on the element score of keys with a prefix ",(0,n.kt)("inlineCode",{parentName:"li"},"player:")," and synchronously update a user's level when the score reaches 1000")))),(0,n.kt)("h3",{id:"how-do-i-use-redisgears"},"How do I use RedisGears?"),(0,n.kt)("p",null,"Run the Docker container:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"docker run -p 6379:6379 redislabs/redisgears:latest\n")),(0,n.kt)("p",null,"For a very simple example that lists all keys in your Redis database with a prefix of ",(0,n.kt)("inlineCode",{parentName:"p"},"person:")," create the following python script and name it ",(0,n.kt)("inlineCode",{parentName:"p"},"hello_gears.py")," :"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python"},"gb = GearsBuilder() gb.run('person:*')\n")),(0,n.kt)("p",null,"Execute your function:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},'docker exec -i redisgears redis-cli RG.PYEXECUTE "`cat hello_gears.py`"\n')),(0,n.kt)("h3",{id:"using-gears-cli"},"Using gears-cli"),(0,n.kt)("p",null,"The gears-cli tool provides an easier way to execute RedisGears functions, specially if you need to pass some parameters too."),(0,n.kt)("p",null,"It's written in Python and can be installed with ",(0,n.kt)("inlineCode",{parentName:"p"},"pip"),":"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"pip install gears-cli\n")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"gears-cli hello_gears.py REQUIREMENTS rgsync\n")),(0,n.kt)("p",null,"Usage:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"gears-cli --help\nusage: gears-cli [-h] [--host HOST] [--port PORT]\n[--requirements REQUIREMENTS] [--password PASSWORD] path [extra_args [extra_args ...]]\n")),(0,n.kt)("h3",{id:"redisgears-references"},"RedisGears references"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://oss.redis.com/redisgears/"},"RedisGears docs")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/RedisGears/rgsync"},"rgsync docs")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.redis.com/latest/modules/redisgears/installing-redisgears/"},"Installing RedisGears")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://redis.com/blog/introduction-to-redisgears/"},"Introduction to RedisGears blog")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://www.youtube.com/watch?v=J4clHQJScZQ&list=PL83Wfqi-zYZFvs80ncPAPHt-CEuimHl6Q&index=3"},"RedisGears GA - RedisConf 2020 video")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://www.youtube.com/watch?v=6SGWx5DtoCQ"},"Conference talk video by creator of RedisGears")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/RedisGears/rgsync/tree/master/examples/mongo"},"Redis Gears sync with MongoDB"))))}h.isMDXComponent=!0},87269:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var a=i(87462),n=(i(67294),i(3905));const o={},r=void 0,s={unversionedId:"howtos/solutions/caching-architecture/common-caching/source-code-movie-app",id:"howtos/solutions/caching-architecture/common-caching/source-code-movie-app",title:"source-code-movie-app",description:"Below are the commands to clone the source code (frontend and backend) for the application used in this tutorial",source:"@site/docs/howtos/solutions/caching-architecture/common-caching/source-code-movie-app.mdx",sourceDirName:"howtos/solutions/caching-architecture/common-caching",slug:"/howtos/solutions/caching-architecture/common-caching/source-code-movie-app",permalink:"/howtos/solutions/caching-architecture/common-caching/source-code-movie-app",draft:!1,editUrl:"https://github.com/redis-developer/redis-developer/edit/master/docs/howtos/solutions/caching-architecture/common-caching/source-code-movie-app.mdx",tags:[],version:"current",lastUpdatedAt:1681340538,formattedLastUpdatedAt:"Apr 12, 2023",frontMatter:{}},c={},d=[],l={toc:d};function h(e){let{components:t,...i}=e;return(0,n.kt)("wrapper",(0,a.Z)({},l,i,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("admonition",{title:"GITHUB CODE",type:"tip"},(0,n.kt)("p",{parentName:"admonition"},"Below are the commands to clone the source code (frontend and backend) for the application used in this tutorial"),(0,n.kt)("p",{parentName:"admonition"},"git clone ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/redis-developer/ebook-speed-mern-frontend.git"},"https://github.com/redis-developer/ebook-speed-mern-frontend.git")),(0,n.kt)("p",{parentName:"admonition"},"git clone ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/redis-developer/ebook-speed-mern-backend.git"},"https://github.com/redis-developer/ebook-speed-mern-backend.git"))))}h.isMDXComponent=!0},72716:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var a=i(87462),n=(i(67294),i(3905));const o={},r=void 0,s={unversionedId:"howtos/solutions/caching-architecture/common-caching/write-behind-vs-write-through",id:"howtos/solutions/caching-architecture/common-caching/write-behind-vs-write-through",title:"write-behind-vs-write-through",description:"There are two related write patterns, and the main differences between them are as follows",source:"@site/docs/howtos/solutions/caching-architecture/common-caching/write-behind-vs-write-through.mdx",sourceDirName:"howtos/solutions/caching-architecture/common-caching",slug:"/howtos/solutions/caching-architecture/common-caching/write-behind-vs-write-through",permalink:"/howtos/solutions/caching-architecture/common-caching/write-behind-vs-write-through",draft:!1,editUrl:"https://github.com/redis-developer/redis-developer/edit/master/docs/howtos/solutions/caching-architecture/common-caching/write-behind-vs-write-through.mdx",tags:[],version:"current",lastUpdatedAt:1681831622,formattedLastUpdatedAt:"Apr 18, 2023",frontMatter:{}},c={},d=[],l={toc:d};function h(e){let{components:t,...i}=e;return(0,n.kt)("wrapper",(0,a.Z)({},l,i,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"There are two related write patterns, and the main differences between them are as follows"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Write Behind"),(0,n.kt)("th",{parentName:"tr",align:null},"Write through"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Syncs data asynchronously"),(0,n.kt)("td",{parentName:"tr",align:null},"Syncs data synchronously/ immediately")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},"Data between the cache and the system of record (database) is ",(0,n.kt)("strong",{parentName:"td"},"inconsistent for a short time")),(0,n.kt)("td",{parentName:"tr",align:null},"Data between the cache and the system of record (database) is always ",(0,n.kt)("strong",{parentName:"td"},"consistent"))))))}h.isMDXComponent=!0},23426:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>u,contentTitle:()=>p,default:()=>k,frontMatter:()=>h,metadata:()=>m,toc:()=>g});var a=i(87462),n=(i(67294),i(3905)),o=i(50358),r=i(2327),s=i(94047),c=i(87269),d=i(72716);const l=i.p+"assets/images/mongo-compass-d5d3ced7efc1ebc24bd5affb75d28dbb.png",h={id:"index-write-behind",title:"How to use Redis for Write-behind Caching",sidebar_label:"How to use Redis for Write-behind Caching",slug:"/howtos/solutions/caching-architecture/write-behind",authors:["prasan","will"]},p=void 0,m={unversionedId:"howtos/solutions/caching-architecture/write-behind/index-write-behind",id:"howtos/solutions/caching-architecture/write-behind/index-write-behind",title:"How to use Redis for Write-behind Caching",description:"What is write-behind caching?",source:"@site/docs/howtos/solutions/caching-architecture/write-behind/index-write-behind.mdx",sourceDirName:"howtos/solutions/caching-architecture/write-behind",slug:"/howtos/solutions/caching-architecture/write-behind",permalink:"/howtos/solutions/caching-architecture/write-behind",draft:!1,editUrl:"https://github.com/redis-developer/redis-developer/edit/master/docs/howtos/solutions/caching-architecture/write-behind/index-write-behind.mdx",tags:[],version:"current",lastUpdatedAt:1700152680,formattedLastUpdatedAt:"Nov 16, 2023",frontMatter:{id:"index-write-behind",title:"How to use Redis for Write-behind Caching",sidebar_label:"How to use Redis for Write-behind Caching",slug:"/howtos/solutions/caching-architecture/write-behind",authors:["prasan","will"]},sidebar:"docs",previous:{title:"How to use Redis for Transaction risk scoring",permalink:"/howtos/solutions/fraud-detection/transaction-risk-scoring"},next:{title:"How to use Redis for Write through caching strategy",permalink:"/howtos/solutions/caching-architecture/write-through"}},u={},g=[{value:"What is write-behind caching?",id:"what-is-write-behind-caching",level:2},{value:"Why you should use Redis for write-behind caching",id:"why-you-should-use-redis-for-write-behind-caching",level:2},{value:"Redis programmability for write-behind caching using RedisGears",id:"redis-programmability-for-write-behind-caching-using-redisgears",level:2},{value:"Write behind caching in a NodeJS application with Redis and MongoDB",id:"write-behind-caching-in-a-nodejs-application-with-redis-and-mongodb",level:2},{value:"Demo application",id:"demo-application",level:3},{value:"Programming Redis using the write-behind pattern",id:"programming-redis-using-the-write-behind-pattern",level:3},{value:"Verifying the write-behind pattern using RedisInsight",id:"verifying-the-write-behind-pattern-using-redisinsight",level:3},{value:"Ready to use Redis for write-behind caching?",id:"ready-to-use-redis-for-write-behind-caching",level:2},{value:"Additional resources",id:"additional-resources",level:2}],w={toc:g};function k(e){let{components:t,...p}=e;return(0,n.kt)("wrapper",(0,a.Z)({},w,p,{components:t,mdxType:"MDXLayout"}),(0,n.kt)(o.Z,{frontMatter:h,mdxType:"Authors"}),(0,n.kt)(c.default,{mdxType:"SourceCodeMovieApp"}),(0,n.kt)("h2",{id:"what-is-write-behind-caching"},"What is write-behind caching?"),(0,n.kt)("p",null,"Imagine you've built a movie streaming app. You used MongoDB as your data store, and as you needed to scale you implemented caching using Redis. This allows you to drastically speed up reads. However, now you are experiencing slowness when writing to MongoDB."),(0,n.kt)("p",null,"For example, maybe you want to allow users to continue watching movies where they last left off. This requires you to store the timestamp of where a user is when they decide to pause the movie. With millions of users, this is starting to cause MongoDB to slow down when you have peaks in demand."),(0,n.kt)("p",null,'You need a way of flattening the peaks in demand, allowing you to write data quickly and then persist it to MongoDB when the demand dies down. What you need is called the "write-behind pattern."'),(0,n.kt)("p",null,"The pattern is simple, your application writes data to Redis and then asynchronously data gets written to MongoDB. Write operations are queued up so that the application can move on quickly and the cache can catch up over time. However, this does mean there is a short time when the data between the cache and the system of record is inconsistent."),(0,n.kt)("p",null,"Below is a diagram of the write-behind pattern for the application:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"write-behind-pattern using Redis in a movie streaming application",src:i(20496).Z,width:"1192",height:"271"})),(0,n.kt)("p",null,"The pattern works as follows:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"The application reads and writes data to Redis."),(0,n.kt)("li",{parentName:"ol"},"Redis syncs any changed data to the MongoDB database asynchronously.")),(0,n.kt)(d.default,{mdxType:"WritePatternDifferences"}),(0,n.kt)("p",null,"Learn more about ",(0,n.kt)("a",{parentName:"p",href:"/howtos/solutions/caching-architecture/write-through"},"Write through pattern")),(0,n.kt)("h2",{id:"why-you-should-use-redis-for-write-behind-caching"},"Why you should use Redis for write-behind caching"),(0,n.kt)("p",null,"Consider Redis with this pattern when you need to"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Flatten peaks in demand"),": Under stress, an application may need to write data quickly. If your application needs to perform a large number of write operations at high speed, consider Redis. The programmability capabilities of Redis make sure the data stored in the cache is synced with the database."),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Batch multiple writes"),": Sometimes it's expensive to write to a database frequently (for example, logging). In those cases, it can be cost-effective to batch the database writes with Redis so that data syncs at intervals."),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Offload the primary database"),": Database load is reduced when heavy writes operate on Redis, So we can spread writes to improve performance during the peak time of application usage.")),(0,n.kt)("h2",{id:"redis-programmability-for-write-behind-caching-using-redisgears"},"Redis programmability for write-behind caching using RedisGears"),(0,n.kt)("admonition",{type:"tip"},(0,n.kt)("p",{parentName:"admonition"},"You can skip reading this section if you are already familiar with RedisGears)")),(0,n.kt)(r.default,{mdxType:"RedisGears"}),(0,n.kt)("h2",{id:"write-behind-caching-in-a-nodejs-application-with-redis-and-mongodb"},"Write behind caching in a NodeJS application with Redis and MongoDB"),(0,n.kt)("h3",{id:"demo-application"},"Demo application"),(0,n.kt)(s.default,{mdxType:"CachingMovieAppDesign"}),(0,n.kt)(c.default,{mdxType:"SourceCodeMovieApp"}),(0,n.kt)("p",null,"To demonstrate this pattern using the movie application, imagine that the user opens the pop-up to add a new movie."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"demo-02",src:i(21128).Z,width:"2608",height:"1332"})),(0,n.kt)("p",null,"Instead of the application immediately storing the data in MongoDB, the application writes the changes to Redis. In the background, RedisGears automatically synchronizes the data with the MongoDB database."),(0,n.kt)("h3",{id:"programming-redis-using-the-write-behind-pattern"},"Programming Redis using the write-behind pattern"),(0,n.kt)("p",null,"Developers need to load some code (say python in our example) to the Redis server before using the write-behind pattern (which syncs data from Redis to MongoDB). The Redis server has a RedisGears module that interprets the python code and syncs the data from Redis to MongoDB."),(0,n.kt)("p",null,"Loading the Python code is easier than it sounds. Simply replace database details in the Python file and then load the file to the Redis server."),(0,n.kt)("p",null,"Create the Python file (shown below, and ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/redis-developer/ebook-speed-mern-backend/blob/main/data/write-behind/movies-write-behind.py"},"available online"),"). Then update the MongoDB connection details, database, collection, and primary key name to sync."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-python",metastring:'title="movies-write-behind.py"',title:'"movies-write-behind.py"'},"# Gears Recipe for a single write behind\n\n# import redis gears & mongo db libs\nfrom rgsync import RGJSONWriteBehind, RGJSONWriteThrough\nfrom rgsync.Connectors import MongoConnector, MongoConnection\n\n# change mongodb connection (admin)\n# mongodb://usrAdmin:passwordAdmin@10.10.20.2:27017/dbSpeedMernDemo?authSource=admin\nmongoUrl = 'mongodb://usrAdmin:passwordAdmin@10.10.20.2:27017/admin'\n\n# MongoConnection(user, password, host, authSource?, fullConnectionUrl?)\nconnection = MongoConnection('', '', '', '', mongoUrl)\n\n# change MongoDB database\ndb = 'dbSpeedMernDemo'\n\n# change MongoDB collection & it's primary key\nmovieConnector = MongoConnector(connection, db, 'movies', 'movieId')\n\n# change redis keys with prefix that must be synced with mongodb collection\nRGJSONWriteBehind(GB,  keysPrefix='MovieEntity',\n                  connector=movieConnector, name='MoviesWriteBehind',\n                  version='99.99.99')\n")),(0,n.kt)("admonition",{title:"What is a RedisGears recipe?",type:"tip"},(0,n.kt)("p",{parentName:"admonition"},"A collection of RedisGears functions and any dependencies they may have that implement a high-level functional purpose is called a ",(0,n.kt)("inlineCode",{parentName:"p"},"recipe"),'.\nExample : "RGJSONWriteBehind" function in above python code')),(0,n.kt)("p",null,"There are two ways to load that Python file into the Redis server:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Using the gears command-line interface (CLI)")),(0,n.kt)("p",null,"Find more information about the Gears CLI at ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/RedisGears/gears-cli"},"gears-cli")," and ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/RedisGears/rgsync#running-the-recipe"},"rgsync"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"# install\npip install gears-cli\n")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"# If python file is located at \u201c/users/tom/movies-write-behind.py\u201d\ngears-cli --host <redisHost> --port <redisPort> --password <redisPassword> run /users/tom/movies-write-behind.py REQUIREMENTS rgsync pymongo==3.12.0\n")),(0,n.kt)("ol",{start:2},(0,n.kt)("li",{parentName:"ol"},"Using the RG.PYEXECUTE from the Redis command line.")),(0,n.kt)("p",null,"Find more information at ",(0,n.kt)("a",{parentName:"p",href:"https://oss.redis.com/redisgears/commands.html#rgpyexecute"},"RG.PYEXECUTE"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-sh"},"# Via redis cli\nRG.PYEXECUTE 'pythonCode' REQUIREMENTS rgsync pymongo==3.12.0\n")),(0,n.kt)("p",null,"The RG.PYEXECUTE command can also be executed from the Node.js code\n(Consult ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/redis-developer/ebook-speed-mern-backend/blob/main/data/write-behind/wb-main.js"},"the sample Node file")," for more details)"),(0,n.kt)("p",null,"Find more examples at ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/RedisGears/rgsync/tree/master/examples/mongo"},"Redis Gears sync with MongoDB"),"."),(0,n.kt)("h3",{id:"verifying-the-write-behind-pattern-using-redisinsight"},"Verifying the write-behind pattern using RedisInsight"),(0,n.kt)("admonition",{type:"tip"},(0,n.kt)("p",{parentName:"admonition"},"RedisInsight is the free redis GUI for viewing data in redis. ",(0,n.kt)("u",null,(0,n.kt)("a",{parentName:"p",href:"https://redis.com/redis-enterprise/redis-insight/"},"Click here to download.")))),(0,n.kt)("p",null,"The next step is to verify that RedisGears is syncing data between Redis and MongoDB."),(0,n.kt)("p",null,"Insert a key starting with the prefix (that's specified in the Python file) using the Redis CLI"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"redis-insight",src:i(26465).Z,width:"1366",height:"110"})),(0,n.kt)("p",null,"Next, confirm that the JSON is inserted in MongoDB too."),(0,n.kt)("img",{src:l,alt:"mongo-compass",width:"500",className:"margin-bottom--md"}),(0,n.kt)("p",null,"You can also check ",(0,n.kt)("a",{parentName:"p",href:"https://redis.com/redis-enterprise/redis-insight/"},"RedisInsight")," to verify that the data is piped in via Streams for its consumers (like RedisGears)."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"redis-insight-stream",src:i(21563).Z,width:"2430",height:"754"})),(0,n.kt)("p",null,"How does all that work with the demo application? Below is a code snipped to insert a movie. Once data is written to Redis, RedisGears automatically synchronizes it to MongoDB."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="BEFORE (using MongoDB)"',title:'"BEFORE',"(using":!0,'MongoDB)"':!0},'...\n//(Node mongo query)\nif (movie) {\n  //insert movie to MongoDB\n  await db.collection("movies")\n           .insertOne(movie);\n}\n...\n')),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="AFTER (using Redis)"',title:'"AFTER',"(using":!0,'Redis)"':!0},"...\n//(Redis OM Node query)\nif (movie) {\n  const entity = repository.createEntity(movie);\n  //insert movie to Redis\n  await moviesRepository.save(entity);\n}\n...\n")),(0,n.kt)("h2",{id:"ready-to-use-redis-for-write-behind-caching"},"Ready to use Redis for write-behind caching?"),(0,n.kt)("p",null,"You now know how to use Redis for write-behind caching. It's possible to incrementally adopt Redis wherever needed with different strategies/patterns. For more resources on the topic of caching, check out the links below:"),(0,n.kt)("h2",{id:"additional-resources"},"Additional resources"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Caching with Redis",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/howtos/solutions/caching-architecture/write-through"},"Write through caching")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/howtos/solutions/caching-architecture/cache-prefetching"},"Cache prefetching")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/howtos/solutions/microservices/caching"},"Query caching")))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://www.youtube.com/c/Redisinc"},"Redis YouTube channel")),(0,n.kt)("li",{parentName:"ul"},"Clients like ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/redis/node-redis"},"Node Redis")," and ",(0,n.kt)("a",{parentName:"li",href:"https://github.com/redis/redis-om-node"},"Redis om Node")," help you to use Redis in Node.js applications."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://redis.com/redis-enterprise/redis-insight/"},"RedisInsight")," : To view your Redis data or to play with raw Redis commands in the workbench"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://redis.com/try-free/"},"Try Redis Cloud for free"))))}k.isMDXComponent=!0},82989:(e,t,i)=>{i.d(t,{Z:()=>a});const a=i.p+"assets/images/demo-01-e8fece1a10d65e2298fa3e312b75ce29.png"},21128:(e,t,i)=>{i.d(t,{Z:()=>a});const a=i.p+"assets/images/demo-02-f0974668ce17cf383b4fb21b4387d514.png"},20496:(e,t,i)=>{i.d(t,{Z:()=>a});const a=i.p+"assets/images/pattern-d208aa7c0439ac303551433256242681.jpg"},21563:(e,t,i)=>{i.d(t,{Z:()=>a});const a=i.p+"assets/images/redis-insight-stream-577d72e570d74a3ed9e1ef4ab10d83c8.png"},26465:(e,t,i)=>{i.d(t,{Z:()=>a});const a=i.p+"assets/images/redis-insight-767112fb9e619960f4ec7a27e5282acb.png"}}]);